<?xml version="1.0"?>
<package version="1.0">

  <description>Tests on TAD IP stack (IPv4, ICMPv4, IPv6, ICMPv6, UDP, TCP functionality.</description>

  <author mailto="Andrew.Rybchenko@oktetlabs.ru"/>

  <req id="TAD_IPSTACK" sticky="true"/> 

  <session>
  
    <run>
      <script name="ip4_raw_send">
        <req id="TAD_IP4"/>
      </script>
      <arg name="env">
        <value>{'host_csap'{addr:'csap_addr':inet:unicast,addr:'csap_hwaddr':ether:unicast,if:'csap_if'},{{'pco':tester},addr:'sock_addr':inet:unicast,addr:'sock_hwaddr':ether:unicast,if:'sock_if'}}</value>
      </arg>
      <arg name="pld_len">
        <value>50</value>
      </arg>
      <arg name="proto">
        <value>IPPROTO_UDP</value>
        <value>IPPROTO_ICMP</value>
      </arg>
      <arg name="hcsum">
        <value>correct</value>
        <value>=1</value>
        <value>+1</value>
      </arg>
    </run> 
   
    <run>
      <script name="ip4_send_icmp">
        <req id="TAD_IP4"/>
      </script>
      <arg name="env">
        <value>{'host_csap'{addr:'csap_addr':inet:unicast,addr:'csap_hwaddr':ether:unicast,if:'csap_if'},{{'pco':tester},addr:'sock_addr':inet:unicast,addr:'sock_hwaddr':ether:unicast,if:'sock_if'}}</value>
      </arg>  
      <arg name="type">
        <value>3</value>
      </arg>
      <arg name="code">
        <value>0</value>
      </arg>
      <arg name="chksum">
        <value>correct</value>
        <value>=1</value>
        <value>=2</value>
      </arg>
    </run> 
   
    <run>
      <script name="ip4_send_udp">
        <req id="TAD_IP4"/>
      </script>
      <arg name="env">
        <value>{'host_csap'{addr:'csap_addr':inet:unicast,addr:'csap_hwaddr':ether:unicast,if:'csap_if'},{{'pco':tester},addr:'sock_addr':inet:unicast,addr:'sock_hwaddr':ether:unicast,if:'sock_if'}}</value>
      </arg>  
      <arg name="pld_len">
        <value>50</value>
      </arg>
      <arg name="chksum">
        <value>correct</value>
        <value>=1</value>
        <value>=2</value>
      </arg>
    </run> 
   
  </session>

</package>
