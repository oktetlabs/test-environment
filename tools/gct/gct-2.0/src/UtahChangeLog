Sat Jul 10 14:32:12 1993  Jeff Law  (law@snake.cs.utah.edu)

	* pa.c (emit_move_sequence): Use cint_ok_for_move instead of
	checking each condition ourselves.

	- pa-ghpux.h (TARGET_DEFAULT): Enable TARGET_JUMP_IN_DELAY.
	- pa-gux7.h (TARGET_DEFAULT): Likewise.
	- pa-utahmach.h (TARGET_DEFAULT): Likewise.
	- pa.h (TARGET_DEFAULT): Likewise.
	- pa1-ghpux.h (TARGET_DEFAULT): Likewise.
	- pa1-utahmach.h (TARGET_DEFAULT): Likewise.
	- pa1.h (TARGET_DEFAULT): Likewise. 

	* pa-utahmach.h (CPP_PREDEFINES): Do not define HPUX_SOURCE, hp700
	or HP700.
	* pa1-utahmach.h (CPP_PREDEFINES): Do not define hp9000s800,
	hp9k8, HPUX_SOURCE or hp800. 

	- Support "eager" delay slot filling and more jump optimizations
	for conditional jumps in PARALLEL insns (eg "addb", "movb").
	- reorg.c (get_jump_flags): Handle conditional jumps in PARALLEL
	insns.
	(get_branch_condition): Likewise.
	(fill_simple_delay_slots): Likewise.
	(fill_eager_delay_slots): Likewise.
	(relax_delay_slots): Likewise.
	(dbr_schedul): Likewise.
	- jump.c (condjump_in_parallel_p): New function to detect
	conditional jumps within PARALLEL insns.
	(jump_optimize): Handle conditional jumps in PARALLEL insns.

	- pa.h (NO_TABLEJUMP_ALIGN): Define.
	- final.c (shorten_branches): Do not try to align jump tables if 
	NO_TABLEJUMP_ALIGN is defined.

	+ loop.c (try_modify_loop_termination): New function.  Tries to
	modify the loop termination conditional so that it is an equality
	comparison against zero.
	(strength_reduce): Call try_modify_loop_termination after
	check_dbra_loop. 

	+ reorg.c (fill_simple_delay_slots): Try filling any insn needing
	delay slots with a JUMP_INSN.

	* Allow unconditional jumps in delay slots of call and millicode
	call instructions.
	* pa.h (TARGET_JUMP_IN_DELAY): New target flag to allow/disallow
	jump instructions in call delay slots.
	(TARGET_SWITCHES): Add -mjump-in-delay and -mno-jump-in-delay.  
	Provide -mno alternatives for most options.
	(output_call): Declare.
	* pa.c (output_call): New function to output a function call or
	millicode call, possibly with a jump in the delay slot.
	(output_mul_insn): Accept additional argument, use output_call.
	(output_div_insn): Likewise.
	(output_mod_insn): Likewise.
	(jump_in_call_delay): New function to determine if the given 
	JUMP_INSN is in the delay slot of a call or millicode call.
	* pa.md (uncond_branch): New type attribute.  Explicitly disallow
	uncond_branch in most delay slots.
	(in_call_delay attribute): New test for delay slot of call insns.
	Allow uncond_branches in the delay slot if TARGET_JUMP_IN_DELAY.
	(define_delay for calls, millicode calls, branches, returns, etc):
	Broken up into two define delays.  One for calls and millicode 
	calls, a second for branches, returns, etc.
	(millicode insns): Pass the current insn down to 
	output_{mul,div,mod}_insn.
	(jump insn): Use "uncond_branch" type attribute.  Length of this
	insn varies if it is in the delay slot of a call.
	(call_internal_symref): Use output_call.
	(call_value_internal_symref): Likewise.
	(call_internal_reg): Use %r syntax instead of just register numbers.
	(call_value_internal_reg): Likewise.
	
	+ pa.h (EXTRA_CONSTRAINT): Delete unused 'S' constraint.
	+ pa.md (call_internal_symref): Make pattern unavailable if
	TARGET_LONG_CALLS.
	(call_value_internal_symref): Likewise.

	+ pa.md (movdf insn): Distinguish between offsettable and
	nonoffsettable memory locations when loading/storing a GR.
	(movdi insn): Likewise.  Loading a DImode constant can take as
	many as 4 insns.

	+ pa.md (zero_extendqihi2): No need to explicitly set a length,
	the defaults are correct.
	(zero_extendqisi2, floatsisf2, floatsidf2): Likewise.
	(floatdisf2, floatdidf2, fix_truncsfsi2): Likewise.
	(fix_truncdfsi2, fix_truncsfdi2, fix_truncdfdi2): Likewise.

	* Resync PA directory with July 9 FSF development sources.
	Fri Jul	 9 20:40:29 1993  Jeffrey A. Law  (law@snake.cs.utah.edu)
	* pa.md (dbra and movb patterns): Fix constraints so that FP
	registers are never preferred.


	Fri Jul  9 16:18:20 1993  Jeffrey A. Law  (law@snake.cs.utah.edu)
	* Change length attributes to use bytes instead of instruction
	counts.
	* pa.h (CASE_VECTOR_MODE): Change to DImode.
	* pa.c (compute_movstrsi_length): Return length in bytes.
	(pa_adjust_insn_length): Return adjustment in bytes.
	(output_cbranch): Handle lengths as bytes.
	(output_bb, output_dbra, output_movb): Likewise.
	* pa.md (default length define_attr): Lengths are in bytes now.
	(asm_attributes): Likewise.
	(delay slot attributes): Deal with lengths in bytes.
	(explicit length computations): Compute length in bytes.

	* Make more dbra insns and support movb insns.
	* pa.h (output_dbra, output_movb): Declare.
	* pa.md (dbra pattern): Use output_dbra.
	(dbra pattern #2): New pattern.  Also use output_dbra.
	(movb, inverted movb): New patterns.
	* pa.c (pa_adjust_insn_length): dbra and movb insns which have
	their output in a FP register do not need adjustment.
	(output_cbranch, output_bb): Handle conditional jump to the
	following instruction.
	(output_dbra): New function extracted from dbra pattern.
	(output_movb): New function.
	(eq_neq_comparison_operator): New function.
	(movb_comparison_operator): New function.


	Wed Jul  7 16:37:26 1993  Jeffrey A. Law  (law@snake.cs.utah.edu)
	* Improve code for conditional branches and dbra insns on the PA.  
	* pa.c (pa_adjust_insn_length): Rewrite so that it only adjusts
	insns which really need adjustment.
	(output_cbranch): Rework so that output templates are simpler.  
	Use shorter sequence for long backwards conditional branches with
	a filled delay slot that is nullified.  More agressively use "skip"
	instructions.  More agressively nullify the delay slot if nothing
	useful could be placed there.
	(output_bb): Likewise.
	(forward_branch_p): New function.
	* pa.md (conditional branches): Use the full displacement range
	for the branch target.  Update length computations to match current
	reality.
	(branch on bit patterns): Likewise.
	(decrement_and_branch_until_zero): Re-enable pattern.  Rewrite to
	be simpler and more efficient.  Also handle case where loop counter
	is in a FP register.


	Sat Jul  3 18:54:07 1993  Jeffrey A. Law  (law@snake.cs.utah.edu)
	* pa.c (call_operand_address): Do not accept registers anymore.
	* pa.md (call expanders): Emit different patterns for named calls
	and indirect calls.
	(call_internal_symref, call_internal_reg): New patterns. 
	(call_internal): Deleted.  Now handled by call_interal_{symref,reg}.
	(call_value_internal_symref, call_value_internal_reg): New patterns.
	(call_value_internal): Deleted.  Now handled by
	call_value_internal_{symref,reg).


	Thu Jul  1 14:56:56 1993  Jeffrey A. Law  (law@snake.cs.utah.edu)
	* pa.h (OVERRIDE_OPTIONS): Define.  Give a warning if -fpic or 
	-fPIC was specified on the command line.

	* configure (hppa1.0-hp-hpux8.02): New target.
	(hppa1.1-hp-hpux8.02): Accept "--gas" in this configuration.
	* pa-oldas.h: New target for 1.0 machines running HPUX 8.02.
	* pa.c (output_arg_descriptor): Reverse polarity of test for
	HP_FP_ARG_DESCRIPTOR_REVERSED.
	* pa.h (ASM_DOUBLE_ARG_DESCRIPTORS): Likewise.
	* pa-hpux7.h (HP_FP_ARG_DESCRIPTOR_REVERSED): Define.
	* pa1-oldas.h (HP_FP_ARG_DESCRIPTOR_REVERSED): Define.
	(TARGET_DEFAULT): Clear useless bits in TARGET_DEFAULT.
	* pa-utahmach.h (HP_FP_ARG_DESCRIPTOR_REVERSED): Do not define here.
	* pa1-utahmach.h (HP_FP_ARG_DESCRIPTOR_REVERSED): Likewise.
	* pa1-ghpux.h (HP_FP_ARG_DESCRIPTOR_REVERSED): Likewise.
	* pa1-hpux.h (HP_FP_ARG_DESCRIPTOR_REVERSED): Likewise.


	Wed Jun 30 13:43:45 1993  Jeffrey A. Law  (law@snake.cs.utah.edu)
	* pa.c (output_function_prologue): Emit SAVE_SP flag if a frame
	pointer is needed.


	Tue Jun 29 22:28:06 1993  Jeffrey A. Law  (law@snake.cs.utah.edu)
	* pa.c (singlemove_string): Use zdepi and ldil to load constants
	into registers when appropriate.


	Fri Jun 25 13:33:39 1993  Jeffrey A. Law  (law@snake.cs.utah.edu)
	* pa-hpux.h (LINK_SPEC): Search shared libraries by default; turn
	off shared library searching of -static is specified.
	* pa-ghpux.h (LINK_SPEC): Likewise.

	* pa.h (TARGET_SHARED_LIBS): Delete switch and all references to
	the switch.
	* pa.c: References to TARGET_SHARED_LIBS deleted.
	* pa.md: Likewise.

	* pa-utahmach.h (TARGET_DEFAULT): Allow indexing on Mach ports.
	* pa1-utahmach.h (TARGET_DEFAULT): Likewise.
	* pa.h (TARGET_DISABLE_INDEXING): Clean up comments.


* -- Indicates a patch already installed into the FSF sources.

+ -- Indicates a patch already submitted to the FSF.

- -- Indicates a patch not yet submitted to the FSF.
