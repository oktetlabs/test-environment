<?xml version="1.0"?>
<backup>

    <!--
        This configuration model is intended for describing of configuration
        related to iptables rules on Agents

        To avoid system-wide iptables rules usage, per-interface chains
        are created. Network interfaces are not shared between test agents
        and iptables rules for different interfaces should not interact
        with each other.

        Copyright (C) 2003-2016 Test Environment authors (see file AUTHORS
        in the root directory of the distribution).

        Test Environment is free software; you can redistribute it
        and/or modify it under the terms of the GNU General Public
        License as published by the Free Software Foundation; either
        version 2 of the License, or (at your option) any later
        version.

        Test Environment is distributed in the hope that it will be
        useful, but WITHOUT ANY WARRANTY; without even the implied
        warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
        PURPOSE. See the GNU General Public License for more details.

        You should have received a copy of the GNU General Public
        License along with this program; if not, write to the Free
        Software Foundation, Inc., 59 Temple Place, Suite 330,
        Boston, MA  02111-1307  USA

        Author: Alexander Kukuta E-mail: Alexander.Kukuta@oktetlabs.ru
        Author: Ivan Melnikov E-mail: Ivan.Melnikov@oktetlabs.ru
    -->

    <!-- Root object of iptables rules for the specific interface.
         Name: empty -->
    <object oid="/agent/interface/iptables" access="read_only" type="none"/>

    <!-- Table name
         Name: filter, mangle, nat or raw -->
    <object oid="/agent/interface/iptables/table" access="read_only" type="none"/>

    <!-- Per-interface chain, may have name of built-in chain
         If TRUE, then jump rule is added to the common chain (without prefix)
         Jump is always conditional with interface matching.
         Input or output direction is assumed by the chain name.
         Name: chain name without <interface>_ prefix -->
    <object oid="/agent/interface/iptables/table/chain" access="read_create" type="boolean"/>

    <!-- Chain rules list. When set operation is performed, the chain is flushed and filled again.
         Name: Empty
         Value: whole list of rules as a single string value in the per-interface chain -->
    <object oid="/agent/interface/iptables/table/chain/rules" access="read_write" type="string"/>

    <!-- Execute iptables command for the chain, used to simplify TAPI 
         Name: Empty
         Value: iptables command to execute -->
    <object oid="/agent/interface/iptables/table/chain/cmd" access="write_only" type="string" volatile="true"/>

    <!-- iptables tool extra options.
         Name: none
         Value: list of iptables tool options, for example "--wait" -->
    <object oid="/agent/iptables_tool_opts" access="read_write" type="string"/>

</backup>
